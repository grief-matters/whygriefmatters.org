---
import type { Polymorphic } from "astro/types";

import {
  textPresetMap,
  type TextPreset,
  type TextProminence,
} from "@styles/utils/typography";
import { textColorMap, type OnSurfaceColorVariant } from "@styles/utils/color";
import type { SpaceSetting } from "@styles/utils/spacing";

type TextElement = "p" | "span" | "h1" | "h2" | "h3" | "h4";

type TextProps = {
  as: TextElement;
  variant?: TextPreset;
  prominence?: TextProminence;
  colorVariant?: OnSurfaceColorVariant;
  textAlign?: "center" | "left";
  marginBottom?: SpaceSetting;
  bold?: boolean;
  italic?: boolean;
};

const typographyMarginBottomMap: Record<SpaceSetting, string> = {
  1: "mb-1",
  2: "mb-3",
  3: "mb-5",
  4: "mb-8",
  5: "",
  6: "",
  7: "",
};

type Props = Polymorphic<TextProps>;

const {
  as: Tag = "p",
  textAlign = "left",
  variant = "body-1",
  prominence = "default",
  colorVariant = "primary",
  marginBottom,
  bold,
  italic,
  ...attrs
} = Astro.props;

const preset = textPresetMap[variant];
const variantClasses = [
  preset.fontFamily,
  preset.fontSize,
  bold ? "font-bold" : preset.fontWeight,
  italic ? "italic" : null,
  variant === "subtitle-1"
    ? textColorMap.coolNeutral.muted
    : textColorMap[colorVariant][prominence],
  Tag.startsWith("h") ? "leading-8 text-balance" : "leading-7",
  textAlign === "center" ? "text-center" : null,
  marginBottom && typographyMarginBottomMap[marginBottom],
];
---

<Tag class:list={variantClasses} {...attrs}>
  <slot />
</Tag>
