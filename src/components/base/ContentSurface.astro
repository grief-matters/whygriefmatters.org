---
import type { Polymorphic } from "astro/types";
import type {
  Prominence,
  SurfaceColorVariant,
} from "@ui/utils/styles";
import {
  paddingXSettingMap,
  paddingYSettingMap,
  type SpaceSetting,
} from "@ui/utils/spacing";

type SurfaceElement = "div" | "article" | "aside" | "section";
export type ContentSurfaceVariant = SurfaceColorVariant | "featureCard";

interface SurfaceOwnProps {
  as: SurfaceElement;
  variant?: ContentSurfaceVariant;
  prominence?: Prominence;
  paddingX?: SpaceSetting;
  paddingY?: SpaceSetting;
  fullHeight?: boolean;
}

type ProminenceClassListMap = Record<Prominence, Array<string>>;

const standardVariantsClassMap: Record<
  SurfaceColorVariant,
  ProminenceClassListMap
> = {
  neutral: {
    default: [
      "bg-contentSurface-neutral--default",
      "border border-line-neutral--default",
    ],
    muted: [
      "bg-contentSurface-neutral--muted",
      "border border-line-neutral--muted",
    ],
    prominent: [
      "bg-contentSurface-neutral--prominent",
      "border border-line-neutral--prominent",
    ],
  },
  primary: {
    default: [
      "bg-contentSurface-primary--default",
      "border border-line-primary--default",
    ],
    muted: [
      "bg-contentSurface-primary--muted",
      "border border-line-primary--muted",
    ],
    prominent: [
      "bg-contentSurface-primary--prominent",
      "border border-line-primary--prominent",
    ],
  },
  secondary: {
    default: [
      "bg-contentSurface-secondary--default",
      "border border-line-secondary--default",
    ],
    muted: [
      "bg-contentSurface-secondary--muted",
      "border border-line-secondary--muted",
    ],
    prominent: [
      "bg-contentSurface-secondary--prominent",
      "border border-line-secondary--prominent",
    ],
  },
  tertiary: {
    default: [
      "bg-contentSurface-tertiary--default",
      "border border-line-tertiary--default",
    ],
    muted: [
      "bg-contentSurface-tertiary--muted",
      "border border-line-tertiary--muted",
    ],
    prominent: [
      "bg-contentSurface-tertiary--prominent",
      "border border-line-tertiary--prominent",
    ],
  },
  primaryContrast: {
    default: ["bg-contentSurface-primaryContrast--default"],
    muted: ["bg-contentSurface-primaryContrast--muted"],
    prominent: ["bg-contentSurface-primaryContrast--prominent"],
  },
};

type Props = Polymorphic<SurfaceOwnProps>;

const {
  as: Tag = "div",
  variant = "neutral",
  prominence = "default",
  paddingX,
  paddingY,
  fullHeight,
  ...attrs
} = Astro.props;

const classes =
  variant === "featureCard"
    ? [
        "shadow-lg bg-contentSurface-neutral--prominent",
        "border border-line-coolNeutral--muted",
      ]
    : [
        standardVariantsClassMap[variant][prominence],
        variant !== "primaryContrast" && "rounded-sm",
      ];
---

<Tag
  class:list={[
    ...classes,
    paddingX ? paddingXSettingMap[paddingX] : null,
    paddingY ? paddingYSettingMap[paddingY] : null,
    fullHeight && "h-full",
  ]}
  {...attrs}
>
  <slot />
</Tag>
