---
import type { Polymorphic } from "astro/types";

import {
  textColorMap,
  textPresetClassMap,
  type OnSurfaceColorVariant,
  type TextPreset,
  type TextProminence,
} from "../utils/styles";
import type { SpaceSetting } from "@ui/utils/spacing";

type TextElement = "p" | "span" | "h1" | "h2" | "h3" | "h4";

type TextProps = {
  as: TextElement;
  variant?: TextPreset;
  prominence?: TextProminence;
  color?: OnSurfaceColorVariant;
  textAlign?: "center" | "left";
  marginBottom?: SpaceSetting;
  bold?: boolean;
  italic?: boolean;
};

const marginBottomMap: Record<SpaceSetting, string> = {
  1: "mb-1",
  2: "mb-3",
  3: "mb-5",
  4: "mb-8",
  5: "",
  6: "",
  7: "",
};

type Props = Polymorphic<TextProps>;

const {
  as: Tag = "p",
  textAlign = "left",
  variant = "body-1",
  prominence = "default",
  color = "primary",
  marginBottom,
  bold,
  italic,
  ...attrs
} = Astro.props;

const variantClasses = [
  textPresetClassMap[variant],
  variant === "subtitle-1"
    ? textColorMap.coolNeutral.muted
    : textColorMap[color][prominence],
  Tag.startsWith("h") ? "leading-8 text-balance" : "leading-7",
  textAlign === "center" ? "text-center" : null,
  marginBottom && marginBottomMap[marginBottom],
  bold && "font-bold",
  italic && "font-italic",
];
---

<Tag class:list={variantClasses} {...attrs}>
  <slot />
</Tag>
